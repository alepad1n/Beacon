(()=>{var e={53:function(e){e.exports=function(){"use strict";var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="ARRAYBUFFER not supported by this environment",n="UINT8ARRAY not supported by this environment";function r(e,t,n,r){var a,o,i,s=t||[0],c=(n=n||0)>>>3,u=-1===r?3:0;for(a=0;a<e.length;a+=1)o=(i=a+c)>>>2,s.length<=o&&s.push(0),s[o]|=e[a]<<8*(u+r*(i%4));return{value:s,binLen:8*e.length+n}}function a(a,o,i){switch(o){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(a){case"HEX":return function(e,t,n){return function(e,t,n,r){var a,o,i,s;if(0!=e.length%2)throw new Error("String of HEX type must be in byte increments");var c=t||[0],u=(n=n||0)>>>3,l=-1===r?3:0;for(a=0;a<e.length;a+=2){if(o=parseInt(e.substr(a,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(i=(s=(a>>>1)+u)>>>2;c.length<=i;)c.push(0);c[i]|=o<<8*(l+r*(s%4))}return{value:c,binLen:4*e.length+n}}(e,t,n,i)};case"TEXT":return function(e,t,n){return function(e,t,n,r,a){var o,i,s,c,u,l,d,h,p=0,v=n||[0],f=(r=r||0)>>>3;if("UTF8"===t)for(d=-1===a?3:0,s=0;s<e.length;s+=1)for(i=[],128>(o=e.charCodeAt(s))?i.push(o):2048>o?(i.push(192|o>>>6),i.push(128|63&o)):55296>o||57344<=o?i.push(224|o>>>12,128|o>>>6&63,128|63&o):(s+=1,o=65536+((1023&o)<<10|1023&e.charCodeAt(s)),i.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),c=0;c<i.length;c+=1){for(u=(l=p+f)>>>2;v.length<=u;)v.push(0);v[u]|=i[c]<<8*(d+a*(l%4)),p+=1}else for(d=-1===a?2:0,h="UTF16LE"===t&&1!==a||"UTF16LE"!==t&&1===a,s=0;s<e.length;s+=1){for(o=e.charCodeAt(s),!0===h&&(o=(c=255&o)<<8|o>>>8),u=(l=p+f)>>>2;v.length<=u;)v.push(0);v[u]|=o<<8*(d+a*(l%4)),p+=2}return{value:v,binLen:8*p+r}}(e,o,t,n,i)};case"B64":return function(t,n,r){return function(t,n,r,a){var o,i,s,c,u,l,d=0,h=n||[0],p=(r=r||0)>>>3,v=-1===a?3:0,f=t.indexOf("=");if(-1===t.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(t=t.replace(/=/g,""),-1!==f&&f<t.length)throw new Error("Invalid '=' found in base-64 string");for(o=0;o<t.length;o+=4){for(c=t.substr(o,4),s=0,i=0;i<c.length;i+=1)s|=e.indexOf(c.charAt(i))<<18-6*i;for(i=0;i<c.length-1;i+=1){for(u=(l=d+p)>>>2;h.length<=u;)h.push(0);h[u]|=(s>>>16-8*i&255)<<8*(v+a*(l%4)),d+=1}}return{value:h,binLen:8*d+r}}(t,n,r,i)};case"BYTES":return function(e,t,n){return function(e,t,n,r){var a,o,i,s,c=t||[0],u=(n=n||0)>>>3,l=-1===r?3:0;for(o=0;o<e.length;o+=1)a=e.charCodeAt(o),i=(s=o+u)>>>2,c.length<=i&&c.push(0),c[i]|=a<<8*(l+r*(s%4));return{value:c,binLen:8*e.length+n}}(e,t,n,i)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(e){throw new Error(t)}return function(e,t,n){return function(e,t,n,a){return r(new Uint8Array(e),t,n,a)}(e,t,n,i)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(e){throw new Error(n)}return function(e,t,n){return r(e,t,n,i)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function o(r,a,o,i){switch(r){case"HEX":return function(e){return function(e,t,n,r){var a,o,i="0123456789abcdef",s="",c=t/8,u=-1===n?3:0;for(a=0;a<c;a+=1)o=e[a>>>2]>>>8*(u+n*(a%4)),s+=i.charAt(o>>>4&15)+i.charAt(15&o);return r.outputUpper?s.toUpperCase():s}(e,a,o,i)};case"B64":return function(t){return function(t,n,r,a){var o,i,s,c,u,l="",d=n/8,h=-1===r?3:0;for(o=0;o<d;o+=3)for(c=o+1<d?t[o+1>>>2]:0,u=o+2<d?t[o+2>>>2]:0,s=(t[o>>>2]>>>8*(h+r*(o%4))&255)<<16|(c>>>8*(h+r*((o+1)%4))&255)<<8|u>>>8*(h+r*((o+2)%4))&255,i=0;i<4;i+=1)l+=8*o+6*i<=n?e.charAt(s>>>6*(3-i)&63):a.b64Pad;return l}(t,a,o,i)};case"BYTES":return function(e){return function(e,t,n){var r,a,o="",i=t/8,s=-1===n?3:0;for(r=0;r<i;r+=1)a=e[r>>>2]>>>8*(s+n*(r%4))&255,o+=String.fromCharCode(a);return o}(e,a,o)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(e){throw new Error(t)}return function(e){return function(e,t,n){var r,a=t/8,o=new ArrayBuffer(a),i=new Uint8Array(o),s=-1===n?3:0;for(r=0;r<a;r+=1)i[r]=e[r>>>2]>>>8*(s+n*(r%4))&255;return o}(e,a,o)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(e){throw new Error(n)}return function(e){return function(e,t,n){var r,a=t/8,o=-1===n?3:0,i=new Uint8Array(a);for(r=0;r<a;r+=1)i[r]=e[r>>>2]>>>8*(o+n*(r%4))&255;return i}(e,a,o)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}var i=4294967296,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],c=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],u=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],l="Chosen SHA variant is not supported",d="Cannot set numRounds with MAC";function h(e,t){var n,r,a=e.binLen>>>3,o=t.binLen>>>3,i=a<<3,s=4-a<<3;if(a%4!=0){for(n=0;n<o;n+=4)r=a+n>>>2,e.value[r]|=t.value[n>>>2]<<i,e.value.push(0),e.value[r+1]|=t.value[n>>>2]>>>s;return(e.value.length<<2)-4>=o+a&&e.value.pop(),{value:e.value,binLen:e.binLen+t.binLen}}return{value:e.value.concat(t.value),binLen:e.binLen+t.binLen}}function p(e){var t={outputUpper:!1,b64Pad:"=",outputLen:-1},n=e||{},r="Output length must be a multiple of 8";if(t.outputUpper=n.outputUpper||!1,n.b64Pad&&(t.b64Pad=n.b64Pad),n.outputLen){if(n.outputLen%8!=0)throw new Error(r);t.outputLen=n.outputLen}else if(n.shakeLen){if(n.shakeLen%8!=0)throw new Error(r);t.outputLen=n.shakeLen}if("boolean"!=typeof t.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw new Error("Invalid b64Pad formatting option");return t}function v(e,t,n,r){var o=e+" must include a value and format";if(!t){if(!r)throw new Error(o);return r}if(void 0===t.value||!t.format)throw new Error(o);return a(t.format,t.encoding||"UTF8",n)(t.value)}var f=function(){function e(e,t,n){var r=n||{};if(this.t=t,this.i=r.encoding||"UTF8",this.numRounds=r.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=e,this.u=[],this.h=0,this.v=!1,this.A=0,this.l=!1,this.H=[],this.S=[]}return e.prototype.update=function(e){var t,n=0,r=this.p>>>5,a=this.m(e,this.u,this.h),o=a.binLen,i=a.value,s=o>>>5;for(t=0;t<s;t+=r)n+this.p<=o&&(this.U=this.R(i.slice(t,t+r),this.U),n+=this.p);return this.A+=n,this.u=i.slice(n>>>5),this.h=o%this.p,this.v=!0,this},e.prototype.getHash=function(e,t){var n,r,a=this.T,i=p(t);if(this.C){if(-1===i.outputLen)throw new Error("Output length must be specified in options");a=i.outputLen}var s=o(e,a,this.F,i);if(this.l&&this.K)return s(this.K(i));for(r=this.g(this.u.slice(),this.h,this.A,this.L(this.U),a),n=1;n<this.numRounds;n+=1)this.C&&a%32!=0&&(r[r.length-1]&=16777215>>>24-a%32),r=this.g(r,a,0,this.B(this.o),a);return s(r)},e.prototype.setHMACKey=function(e,t,n){if(!this.k)throw new Error("Variant does not support HMAC");if(this.v)throw new Error("Cannot set MAC key after calling update");var r=a(t,(n||{}).encoding||"UTF8",this.F);this.Y(r(e))},e.prototype.Y=function(e){var t,n=this.p>>>3,r=n/4-1;if(1!==this.numRounds)throw new Error(d);if(this.l)throw new Error("MAC key already set");for(n<e.binLen/8&&(e.value=this.g(e.value,e.binLen,0,this.B(this.o),this.T));e.value.length<=r;)e.value.push(0);for(t=0;t<=r;t+=1)this.H[t]=909522486^e.value[t],this.S[t]=1549556828^e.value[t];this.U=this.R(this.H,this.U),this.A=this.p,this.l=!0},e.prototype.getHMAC=function(e,t){var n=p(t);return o(e,this.T,this.F,n)(this.N())},e.prototype.N=function(){var e;if(!this.l)throw new Error("Cannot call getHMAC without first setting MAC key");var t=this.g(this.u.slice(),this.h,this.A,this.L(this.U),this.T);return e=this.R(this.S,this.B(this.o)),this.g(t,this.T,this.p,e,this.T)},e}(),m=function(e,t){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},m(e,t)};function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function g(e,t){return e<<t|e>>>32-t}function y(e,t){return e>>>t|e<<32-t}function b(e,t){return e>>>t}function E(e,t,n){return e^t^n}function I(e,t,n){return e&t^~e&n}function A(e,t,n){return e&t^e&n^t&n}function k(e){return y(e,2)^y(e,13)^y(e,22)}function L(e,t){var n=(65535&e)+(65535&t);return(65535&(e>>>16)+(t>>>16)+(n>>>16))<<16|65535&n}function M(e,t,n,r){var a=(65535&e)+(65535&t)+(65535&n)+(65535&r);return(65535&(e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(a>>>16))<<16|65535&a}function T(e,t,n,r,a){var o=(65535&e)+(65535&t)+(65535&n)+(65535&r)+(65535&a);return(65535&(e>>>16)+(t>>>16)+(n>>>16)+(r>>>16)+(a>>>16)+(o>>>16))<<16|65535&o}function S(e){return y(e,7)^y(e,18)^b(e,3)}function B(e){return y(e,6)^y(e,11)^y(e,25)}function H(e){return[1732584193,4023233417,2562383102,271733878,3285377520]}function C(e,t){var n,r,a,o,i,s,c,u=[];for(n=t[0],r=t[1],a=t[2],o=t[3],i=t[4],c=0;c<80;c+=1)u[c]=c<16?e[c]:g(u[c-3]^u[c-8]^u[c-14]^u[c-16],1),s=c<20?T(g(n,5),I(r,a,o),i,1518500249,u[c]):c<40?T(g(n,5),E(r,a,o),i,1859775393,u[c]):c<60?T(g(n,5),A(r,a,o),i,2400959708,u[c]):T(g(n,5),E(r,a,o),i,3395469782,u[c]),i=o,o=a,a=g(r,30),r=n,n=s;return t[0]=L(n,t[0]),t[1]=L(r,t[1]),t[2]=L(a,t[2]),t[3]=L(o,t[3]),t[4]=L(i,t[4]),t}function U(e,t,n,r){for(var a,o=15+(t+65>>>9<<4),s=t+n;e.length<=o;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[o]=4294967295&s,e[o-1]=s/i|0,a=0;a<e.length;a+=16)r=C(e.slice(a,a+16),r);return r}var _=function(e){function t(t,n,r){var o=this;if("SHA-1"!==t)throw new Error(l);var i=r||{};return(o=e.call(this,t,n,r)||this).k=!0,o.K=o.N,o.F=-1,o.m=a(o.t,o.i,o.F),o.R=C,o.L=function(e){return e.slice()},o.B=H,o.g=U,o.U=[1732584193,4023233417,2562383102,271733878,3285377520],o.p=512,o.T=160,o.C=!1,i.hmacKey&&o.Y(v("hmacKey",i.hmacKey,o.F)),o}return w(t,e),t}(f);function x(e){return"SHA-224"==e?c.slice():u.slice()}function R(e,t){var n,r,a,o,i,c,u,l,d,h,p,v,f=[];for(n=t[0],r=t[1],a=t[2],o=t[3],i=t[4],c=t[5],u=t[6],l=t[7],p=0;p<64;p+=1)f[p]=p<16?e[p]:M(y(v=f[p-2],17)^y(v,19)^b(v,10),f[p-7],S(f[p-15]),f[p-16]),d=T(l,B(i),I(i,c,u),s[p],f[p]),h=L(k(n),A(n,r,a)),l=u,u=c,c=i,i=L(o,d),o=a,a=r,r=n,n=L(d,h);return t[0]=L(n,t[0]),t[1]=L(r,t[1]),t[2]=L(a,t[2]),t[3]=L(o,t[3]),t[4]=L(i,t[4]),t[5]=L(c,t[5]),t[6]=L(u,t[6]),t[7]=L(l,t[7]),t}var N=function(e){function t(t,n,r){var o=this;if("SHA-224"!==t&&"SHA-256"!==t)throw new Error(l);var s=r||{};return(o=e.call(this,t,n,r)||this).K=o.N,o.k=!0,o.F=-1,o.m=a(o.t,o.i,o.F),o.R=R,o.L=function(e){return e.slice()},o.B=x,o.g=function(e,n,r,a){return function(e,t,n,r,a){for(var o,s=15+(t+65>>>9<<4),c=t+n;e.length<=s;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[s]=4294967295&c,e[s-1]=c/i|0,o=0;o<e.length;o+=16)r=R(e.slice(o,o+16),r);return"SHA-224"===a?[r[0],r[1],r[2],r[3],r[4],r[5],r[6]]:r}(e,n,r,a,t)},o.U=x(t),o.p=512,o.T="SHA-224"===t?224:256,o.C=!1,s.hmacKey&&o.Y(v("hmacKey",s.hmacKey,o.F)),o}return w(t,e),t}(f),K=function(e,t){this.I=e,this.M=t};function P(e,t){var n;return t>32?(n=64-t,new K(e.M<<t|e.I>>>n,e.I<<t|e.M>>>n)):0!==t?(n=32-t,new K(e.I<<t|e.M>>>n,e.M<<t|e.I>>>n)):e}function F(e,t){var n;return t<32?(n=32-t,new K(e.I>>>t|e.M<<n,e.M>>>t|e.I<<n)):(n=64-t,new K(e.M>>>t|e.I<<n,e.I>>>t|e.M<<n))}function O(e,t){return new K(e.I>>>t,e.M>>>t|e.I<<32-t)}function Y(e,t,n){return new K(e.I&t.I^~e.I&n.I,e.M&t.M^~e.M&n.M)}function D(e,t,n){return new K(e.I&t.I^e.I&n.I^t.I&n.I,e.M&t.M^e.M&n.M^t.M&n.M)}function j(e){var t=F(e,28),n=F(e,34),r=F(e,39);return new K(t.I^n.I^r.I,t.M^n.M^r.M)}function z(e,t){var n,r;n=(65535&e.M)+(65535&t.M);var a=(65535&(r=(e.M>>>16)+(t.M>>>16)+(n>>>16)))<<16|65535&n;return n=(65535&e.I)+(65535&t.I)+(r>>>16),r=(e.I>>>16)+(t.I>>>16)+(n>>>16),new K((65535&r)<<16|65535&n,a)}function q(e,t,n,r){var a,o;a=(65535&e.M)+(65535&t.M)+(65535&n.M)+(65535&r.M);var i=(65535&(o=(e.M>>>16)+(t.M>>>16)+(n.M>>>16)+(r.M>>>16)+(a>>>16)))<<16|65535&a;return a=(65535&e.I)+(65535&t.I)+(65535&n.I)+(65535&r.I)+(o>>>16),o=(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(r.I>>>16)+(a>>>16),new K((65535&o)<<16|65535&a,i)}function X(e,t,n,r,a){var o,i;o=(65535&e.M)+(65535&t.M)+(65535&n.M)+(65535&r.M)+(65535&a.M);var s=(65535&(i=(e.M>>>16)+(t.M>>>16)+(n.M>>>16)+(r.M>>>16)+(a.M>>>16)+(o>>>16)))<<16|65535&o;return o=(65535&e.I)+(65535&t.I)+(65535&n.I)+(65535&r.I)+(65535&a.I)+(i>>>16),i=(e.I>>>16)+(t.I>>>16)+(n.I>>>16)+(r.I>>>16)+(a.I>>>16)+(o>>>16),new K((65535&i)<<16|65535&o,s)}function J(e,t){return new K(e.I^t.I,e.M^t.M)}function W(e){var t=F(e,1),n=F(e,8),r=O(e,7);return new K(t.I^n.I^r.I,t.M^n.M^r.M)}function V(e){var t=F(e,14),n=F(e,18),r=F(e,41);return new K(t.I^n.I^r.I,t.M^n.M^r.M)}var G=[new K(s[0],3609767458),new K(s[1],602891725),new K(s[2],3964484399),new K(s[3],2173295548),new K(s[4],4081628472),new K(s[5],3053834265),new K(s[6],2937671579),new K(s[7],3664609560),new K(s[8],2734883394),new K(s[9],1164996542),new K(s[10],1323610764),new K(s[11],3590304994),new K(s[12],4068182383),new K(s[13],991336113),new K(s[14],633803317),new K(s[15],3479774868),new K(s[16],2666613458),new K(s[17],944711139),new K(s[18],2341262773),new K(s[19],2007800933),new K(s[20],1495990901),new K(s[21],1856431235),new K(s[22],3175218132),new K(s[23],2198950837),new K(s[24],3999719339),new K(s[25],766784016),new K(s[26],2566594879),new K(s[27],3203337956),new K(s[28],1034457026),new K(s[29],2466948901),new K(s[30],3758326383),new K(s[31],168717936),new K(s[32],1188179964),new K(s[33],1546045734),new K(s[34],1522805485),new K(s[35],2643833823),new K(s[36],2343527390),new K(s[37],1014477480),new K(s[38],1206759142),new K(s[39],344077627),new K(s[40],1290863460),new K(s[41],3158454273),new K(s[42],3505952657),new K(s[43],106217008),new K(s[44],3606008344),new K(s[45],1432725776),new K(s[46],1467031594),new K(s[47],851169720),new K(s[48],3100823752),new K(s[49],1363258195),new K(s[50],3750685593),new K(s[51],3785050280),new K(s[52],3318307427),new K(s[53],3812723403),new K(s[54],2003034995),new K(s[55],3602036899),new K(s[56],1575990012),new K(s[57],1125592928),new K(s[58],2716904306),new K(s[59],442776044),new K(s[60],593698344),new K(s[61],3733110249),new K(s[62],2999351573),new K(s[63],3815920427),new K(3391569614,3928383900),new K(3515267271,566280711),new K(3940187606,3454069534),new K(4118630271,4000239992),new K(116418474,1914138554),new K(174292421,2731055270),new K(289380356,3203993006),new K(460393269,320620315),new K(685471733,587496836),new K(852142971,1086792851),new K(1017036298,365543100),new K(1126000580,2618297676),new K(1288033470,3409855158),new K(1501505948,4234509866),new K(1607167915,987167468),new K(1816402316,1246189591)];function Z(e){return"SHA-384"===e?[new K(3418070365,c[0]),new K(1654270250,c[1]),new K(2438529370,c[2]),new K(355462360,c[3]),new K(1731405415,c[4]),new K(41048885895,c[5]),new K(3675008525,c[6]),new K(1203062813,c[7])]:[new K(u[0],4089235720),new K(u[1],2227873595),new K(u[2],4271175723),new K(u[3],1595750129),new K(u[4],2917565137),new K(u[5],725511199),new K(u[6],4215389547),new K(u[7],327033209)]}function Q(e,t){var n,r,a,o,i,s,c,u,l,d,h,p,v,f,m,w,g=[];for(n=t[0],r=t[1],a=t[2],o=t[3],i=t[4],s=t[5],c=t[6],u=t[7],h=0;h<80;h+=1)h<16?(p=2*h,g[h]=new K(e[p],e[p+1])):g[h]=q((void 0,void 0,void 0,f=F(v=g[h-2],19),m=F(v,61),w=O(v,6),new K(f.I^m.I^w.I,f.M^m.M^w.M)),g[h-7],W(g[h-15]),g[h-16]),l=X(u,V(i),Y(i,s,c),G[h],g[h]),d=z(j(n),D(n,r,a)),u=c,c=s,s=i,i=z(o,l),o=a,a=r,r=n,n=z(l,d);return t[0]=z(n,t[0]),t[1]=z(r,t[1]),t[2]=z(a,t[2]),t[3]=z(o,t[3]),t[4]=z(i,t[4]),t[5]=z(s,t[5]),t[6]=z(c,t[6]),t[7]=z(u,t[7]),t}var $=function(e){function t(t,n,r){var o=this;if("SHA-384"!==t&&"SHA-512"!==t)throw new Error(l);var s=r||{};return(o=e.call(this,t,n,r)||this).K=o.N,o.k=!0,o.F=-1,o.m=a(o.t,o.i,o.F),o.R=Q,o.L=function(e){return e.slice()},o.B=Z,o.g=function(e,n,r,a){return function(e,t,n,r,a){for(var o,s=31+(t+129>>>10<<5),c=t+n;e.length<=s;)e.push(0);for(e[t>>>5]|=128<<24-t%32,e[s]=4294967295&c,e[s-1]=c/i|0,o=0;o<e.length;o+=32)r=Q(e.slice(o,o+32),r);return"SHA-384"===a?[r[0].I,r[0].M,r[1].I,r[1].M,r[2].I,r[2].M,r[3].I,r[3].M,r[4].I,r[4].M,r[5].I,r[5].M]:[r[0].I,r[0].M,r[1].I,r[1].M,r[2].I,r[2].M,r[3].I,r[3].M,r[4].I,r[4].M,r[5].I,r[5].M,r[6].I,r[6].M,r[7].I,r[7].M]}(e,n,r,a,t)},o.U=Z(t),o.p=1024,o.T="SHA-384"===t?384:512,o.C=!1,s.hmacKey&&o.Y(v("hmacKey",s.hmacKey,o.F)),o}return w(t,e),t}(f),ee=[new K(0,1),new K(0,32898),new K(2147483648,32906),new K(2147483648,2147516416),new K(0,32907),new K(0,2147483649),new K(2147483648,2147516545),new K(2147483648,32777),new K(0,138),new K(0,136),new K(0,2147516425),new K(0,2147483658),new K(0,2147516555),new K(2147483648,139),new K(2147483648,32905),new K(2147483648,32771),new K(2147483648,32770),new K(2147483648,128),new K(0,32778),new K(2147483648,2147483658),new K(2147483648,2147516545),new K(2147483648,32896),new K(0,2147483649),new K(2147483648,2147516424)],te=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function ne(e){var t,n=[];for(t=0;t<5;t+=1)n[t]=[new K(0,0),new K(0,0),new K(0,0),new K(0,0),new K(0,0)];return n}function re(e){var t,n=[];for(t=0;t<5;t+=1)n[t]=e[t].slice();return n}function ae(e,t){var n,r,a,o,i,s,c,u,l,d=[],h=[];if(null!==e)for(r=0;r<e.length;r+=2)t[(r>>>1)%5][(r>>>1)/5|0]=J(t[(r>>>1)%5][(r>>>1)/5|0],new K(e[r+1],e[r]));for(n=0;n<24;n+=1){for(o=ne(),r=0;r<5;r+=1)d[r]=(i=t[r][0],s=t[r][1],c=t[r][2],u=t[r][3],l=t[r][4],new K(i.I^s.I^c.I^u.I^l.I,i.M^s.M^c.M^u.M^l.M));for(r=0;r<5;r+=1)h[r]=J(d[(r+4)%5],P(d[(r+1)%5],1));for(r=0;r<5;r+=1)for(a=0;a<5;a+=1)t[r][a]=J(t[r][a],h[r]);for(r=0;r<5;r+=1)for(a=0;a<5;a+=1)o[a][(2*r+3*a)%5]=P(t[r][a],te[r][a]);for(r=0;r<5;r+=1)for(a=0;a<5;a+=1)t[r][a]=J(o[r][a],new K(~o[(r+1)%5][a].I&o[(r+2)%5][a].I,~o[(r+1)%5][a].M&o[(r+2)%5][a].M));t[0][0]=J(t[0][0],ee[n])}return t}function oe(e){var t,n,r=0,a=[0,0],o=[4294967295&e,e/i&2097151];for(t=6;t>=0;t--)0==(n=o[t>>2]>>>8*t&255)&&0===r||(a[r+1>>2]|=n<<8*(r+1),r+=1);return r=0!==r?r:1,a[0]|=r,{value:r+1>4?a:[a[0]],binLen:8+8*r}}function ie(e){return h(oe(e.binLen),e)}function se(e,t){var n,r=oe(t),a=t>>>2,o=(a-(r=h(r,e)).value.length%a)%a;for(n=0;n<o;n++)r.value.push(0);return r.value}var ce=function(e){function t(t,n,r){var o=this,i=6,s=0,c=r||{};if(1!==(o=e.call(this,t,n,r)||this).numRounds){if(c.kmacKey||c.hmacKey)throw new Error(d);if("CSHAKE128"===o.o||"CSHAKE256"===o.o)throw new Error("Cannot set numRounds for CSHAKE variants")}switch(o.F=1,o.m=a(o.t,o.i,o.F),o.R=ae,o.L=re,o.B=ne,o.U=ne(),o.C=!1,t){case"SHA3-224":o.p=s=1152,o.T=224,o.k=!0,o.K=o.N;break;case"SHA3-256":o.p=s=1088,o.T=256,o.k=!0,o.K=o.N;break;case"SHA3-384":o.p=s=832,o.T=384,o.k=!0,o.K=o.N;break;case"SHA3-512":o.p=s=576,o.T=512,o.k=!0,o.K=o.N;break;case"SHAKE128":i=31,o.p=s=1344,o.T=-1,o.C=!0,o.k=!1,o.K=null;break;case"SHAKE256":i=31,o.p=s=1088,o.T=-1,o.C=!0,o.k=!1,o.K=null;break;case"KMAC128":i=4,o.p=s=1344,o.X(r),o.T=-1,o.C=!0,o.k=!1,o.K=o.O;break;case"KMAC256":i=4,o.p=s=1088,o.X(r),o.T=-1,o.C=!0,o.k=!1,o.K=o.O;break;case"CSHAKE128":o.p=s=1344,i=o.j(r),o.T=-1,o.C=!0,o.k=!1,o.K=null;break;case"CSHAKE256":o.p=s=1088,i=o.j(r),o.T=-1,o.C=!0,o.k=!1,o.K=null;break;default:throw new Error(l)}return o.g=function(e,t,n,r,a){return function(e,t,n,r,a,o,i){var s,c,u=0,l=[],d=a>>>5,h=t>>>5;for(s=0;s<h&&t>=a;s+=d)r=ae(e.slice(s,s+d),r),t-=a;for(e=e.slice(s),t%=a;e.length<d;)e.push(0);for(e[(s=t>>>3)>>2]^=o<<s%4*8,e[d-1]^=2147483648,r=ae(e,r);32*l.length<i&&(c=r[u%5][u/5|0],l.push(c.M),!(32*l.length>=i));)l.push(c.I),0==64*(u+=1)%a&&(ae(null,r),u=0);return l}(e,t,0,r,s,i,a)},c.hmacKey&&o.Y(v("hmacKey",c.hmacKey,o.F)),o}return w(t,e),t.prototype.j=function(e,t){var n=function(e){var t=e||{};return{funcName:v("funcName",t.funcName,1,{value:[],binLen:0}),customization:v("Customization",t.customization,1,{value:[],binLen:0})}}(e||{});t&&(n.funcName=t);var r=h(ie(n.funcName),ie(n.customization));if(0!==n.customization.binLen||0!==n.funcName.binLen){for(var a=se(r,this.p>>>3),o=0;o<a.length;o+=this.p>>>5)this.U=this.R(a.slice(o,o+(this.p>>>5)),this.U),this.A+=this.p;return 4}return 31},t.prototype.X=function(e){var t=function(e){var t=e||{};return{kmacKey:v("kmacKey",t.kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:v("Customization",t.customization,1,{value:[],binLen:0})}}(e||{});this.j(e,t.funcName);for(var n=se(ie(t.kmacKey),this.p>>>3),r=0;r<n.length;r+=this.p>>>5)this.U=this.R(n.slice(r,r+(this.p>>>5)),this.U),this.A+=this.p;this.l=!0},t.prototype.O=function(e){var t=h({value:this.u.slice(),binLen:this.h},function(e){var t,n,r=0,a=[0,0],o=[4294967295&e,e/i&2097151];for(t=6;t>=0;t--)0==(n=o[t>>2]>>>8*t&255)&&0===r||(a[r>>2]|=n<<8*r,r+=1);return a[(r=0!==r?r:1)>>2]|=r<<8*r,{value:r+1>4?a:[a[0]],binLen:8+8*r}}(e.outputLen));return this.g(t.value,t.binLen,this.A,this.L(this.U),e.outputLen)},t}(f);return function(){function e(e,t,n){if("SHA-1"==e)this._=new _(e,t,n);else if("SHA-224"==e||"SHA-256"==e)this._=new N(e,t,n);else if("SHA-384"==e||"SHA-512"==e)this._=new $(e,t,n);else{if("SHA3-224"!=e&&"SHA3-256"!=e&&"SHA3-384"!=e&&"SHA3-512"!=e&&"SHAKE128"!=e&&"SHAKE256"!=e&&"CSHAKE128"!=e&&"CSHAKE256"!=e&&"KMAC128"!=e&&"KMAC256"!=e)throw new Error(l);this._=new ce(e,t,n)}}return e.prototype.update=function(e){return this._.update(e),this},e.prototype.getHash=function(e,t){return this._.getHash(e,t)},e.prototype.setHMACKey=function(e,t,n){this._.setHMACKey(e,t,n)},e.prototype.getHMAC=function(e,t){return this._.getHMAC(e,t)},e}()}()},833:(e,t,n)=>{"use strict";let r=n(53);function a(e){return parseInt(e,16)}function o(e,t,n){return t+1>=e.length&&(e=Array(t+1-e.length).join(n)+e),e}r.default&&(r=r.default),e.exports=function(e,t){let n,i,s,c,u,l;var d;return(t=t||{}).period=t.period||30,t.algorithm=t.algorithm||"SHA-1",t.digits=t.digits||6,t.timestamp=t.timestamp||Date.now(),e=function(e){let t="",n="";e=e.replace(/=+$/,"");for(let n=0;n<e.length;n++){let r="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(e.charAt(n).toUpperCase());if(-1===r)throw new Error("Invalid base32 character in key");t+=o(r.toString(2),5,"0")}for(let e=0;e+8<=t.length;e+=8){let r=t.substr(e,8);n+=o(parseInt(r,2).toString(16),2,"0")}return n}(e),n=Math.floor(t.timestamp/1e3),i=o(((d=Math.floor(n/t.period))<15.5?"0":"")+Math.round(d).toString(16),16,"0"),s=new r(t.algorithm,"HEX"),s.setHMACKey(e,"HEX"),s.update(i),c=s.getHMAC("HEX"),u=a(c.substring(c.length-1)),l=(a(c.substr(2*u,8))&a("7fffffff"))+"",l=l.substr(Math.max(l.length-t.digits,0),t.digits),l}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";function e(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class t{constructor(t){e(this,"element",null),e(this,"pageMap",{}),e(this,"currentPageName",null),this.element=t;var n=t.querySelectorAll("div.page-panel-page");for(var r of n){var a=r.getAttribute("page");this.pageMap[a]=r,r.classList.contains("page-panel-visible")&&(this.currentPageName=a)}var o=t.querySelectorAll("div.page-panel-nav a");for(var i of o){var s=i.getAttribute("page");this.pageMap[s]&&(this.pageMap[s].link=i,i.addEventListener("click",(e=>{e.preventDefault(),this.switchPage(e.target.getAttribute("page"))})))}var c=new Event("panelCreated");c.panel=this,this.element.dispatchEvent(c)}switchPage(e){var t=this.currentPageName;if(t!==e&&this.pageMap[e]){this.pageMap[t].classList.remove("page-panel-visible"),this.pageMap[t].link.parentElement.classList.remove("page-panel-active"),this.pageMap[e].classList.add("page-panel-visible"),this.pageMap[e].link.parentElement.classList.add("page-panel-active"),this.currentPageName=e;var n=new Event("panelSwitched");n.panel=this,this.element.dispatchEvent(n)}}static init(){var e=document.querySelectorAll("div.page-panel");for(var n of e)t.pagePanels[n.id]=new t(n)}}function r(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e(t,"pagePanels",{});class a{static show(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Ok";return this.confirm(e,t,n,null)}static confirm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Ok",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Cancel";return new Promise(((a,o)=>{var i=document.getElementById("overlay"),s=document.getElementById("dialog"),c=document.getElementById("dialog_message"),u=document.getElementById("dialog_explanation"),l=document.getElementById("dialog_action_button"),d=document.getElementById("dialog_cancel_button");i&&s&&c&&u&&l&&d?(i.className="exist",s.className="exist",setTimeout((()=>{i.className="exist visible",s.className="exist visible"}),10),c.innerText=e,u.innerText=t||"",l.clickHandler&&l.removeEventListener("click",l.clickHandler),d.clickHandler&&d.removeEventListener("click",d.clickHandler),l.clickHandler=()=>{this.hide(),setTimeout((()=>{a()}),300)},l.addEventListener("click",l.clickHandler),l.innerText=n,r?(d.clickHandler=()=>{this.hide(),setTimeout((()=>{o()}),300)},d.addEventListener("click",d.clickHandler),d.innerText=r):d.className="hidden"):o()}))}static hide(){var e=document.getElementById("overlay"),t=document.getElementById("dialog");e&&t&&(e.className="exist",t.className="exist",setTimeout((()=>{e.className="",t.className=""}),300))}static showModal(e){if(!this.activeModal){var t=document.getElementById("overlay"),n=document.getElementById(e);t&&n&&(t.classList.add("exist"),n.classList.add("exist"),this.activeModal=e,setTimeout((()=>{t.classList.add("visible"),n.classList.add("visible")}),10),this.viewportWatcher=setInterval((()=>{if(this.activeModal){document.querySelectorAll("#".concat(this.activeModal," .modal-content .content")).forEach((e=>{n.classList.toggle("scrolled",e.scrollHeight>e.clientHeight)}));var e=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);n.classList.toggle("centered",n.clientHeight>.75*e)}}),100))}}static hideModal(){return new Promise(((e,t)=>{if(this.activeModal){var n=document.getElementById("overlay"),r=document.getElementById(this.activeModal);n&&r?(this.viewportWatcher&&(clearInterval(this.viewportWatcher),this.viewportWatcher=null),n.classList.remove("visible"),r.classList.remove("visible"),setTimeout((()=>{n.classList.remove("exist"),r.classList.remove("exist"),this.activeModal=null,e()}),300)):t()}else t()}))}}r(a,"activeModal",null),r(a,"viewportWatcher",null);class o{static prepareResponse(e){return{xhr:e,status:e.status,statusText:e.statusText,body:e.responseText,success:e.status>=200&&e.status<300||304===e.status}}static start(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return new Promise(((a,o)=>{var i=new XMLHttpRequest;if(i.open(e,t,!0),"object"==typeof r&&null!==r&&!1===Array.isArray(r)){var s=Object.keys(r);for(var c of s)i.setRequestHeader(c,r[c])}i.onload=()=>{var e=this.prepareResponse(i);e.success?a(e):o(e)},i.onerror=()=>{o(this.prepareResponse(i))},i.send(n)}))}static get(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o.start("GET",e,null,t)}static post(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t instanceof URLSearchParams?(n["Content-Type"]="application/x-www-form-urlencoded",o.start("POST",e,t.toString(),n)):"object"==typeof t&&null!==t||Array.isArray(t)?(n["Content-Type"]="application/json",o.start("POST",e,JSON.stringify(t),n)):o.start("POST",e,t,n)}static delete(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return o.start("DELETE",e,null,t)}}var i=n(833),s=n.n(i);document.addEventListener("beaconRunAccountPanel",(e=>{var{accountProperties:n}=e,r="",i=n.sessionId,c=n.apiDomain,u=document.getElementById("account-user-header"),l=u.getAttribute("beacon-user-name"),d=u.getAttribute("beacon-user-suffix"),h="".concat(l,"#").concat(d),p=()=>{var e=window.location.hash;return e?(e.startsWith("#")&&(e=e.substr(1)),e):""};t.init();var v=t.pagePanels["panel-account"];v&&(v.switchPage(p()),window.addEventListener("popstate",(()=>{v.switchPage(p())})));var f=document.getElementById("panel-account");f&&f.addEventListener("panelSwitched",(e=>{window.location.hash=e.panel.currentPageName}));var m=document.querySelectorAll('#panel-account div[page="projects"] [beacon-action="delete"]');for(var w of m)w.addEventListener("click",(e=>{e.preventDefault();var t=e.target.getAttribute("beacon-resource-url"),n=e.target.getAttribute("beacon-resource-name");return a.confirm('Are you sure you want to delete the project "'+n+'?"',"The project will be deleted immediately and cannot be recovered.","Delete").then((()=>{o.delete(t,{Authorization:"Bearer ".concat(i)}).then((()=>{a.show("Project deleted",'"'+n+'" has been deleted.').then((()=>{window.location.reload(!0)}))})).catch((e=>{401===e.status?a.show("Project not deleted","There was an authentication error"):a.show("Project not deleted","Sorry, there was a ".concat(e.status," error."))}))})).catch((()=>{})),!1}));var g=document.getElementById("omni_show_instructions_internet");g&&g.addEventListener("click",(e=>{e.preventDefault();var t=document.getElementById("omni_instructions_internet");t&&(t.classList.contains("hidden")?t.classList.remove("hidden"):t.classList.add("hidden"))}));var y=document.getElementById("omni_show_instructions_no_internet");if(y&&y.addEventListener("click",(e=>{e.preventDefault();var t=document.getElementById("omni_instructions_no_internet");t&&(t.classList.contains("hidden")?t.classList.remove("hidden"):t.classList.add("hidden"))})),self.fetch&&window.FileReader&&"classList"in document.createElement("a")){var b=e=>{var t=new FormData;t.append("file",e),fetch(document.getElementById("upload_activation_form").getAttribute("action"),{method:"POST",body:t,credentials:"same-origin",headers:{Accept:"application/json"}}).then((function(e){if(e.ok){var t=e.headers.get("content-disposition"),n=/"([^"]*)"/.exec(t),r=null!=n&&n[1]?n[1]:"Default.beaconidentity";e.blob().then((e=>{var t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download=r,document.body.appendChild(t),t.click(),document.body.removeChild(t)}))}else e.json().then((e=>{var t={message:"Unable to create authorization file",explanation:"Sorry, there was an error creating the authorization file."};e.message&&(t.explanation+=" "+e.message.trim()),t.explanation.endsWith(".")||(t.explanation+="."),a.show(t.message,t.explanation)}))})).catch((e=>{a.show("Unable to create authorization file","There was a network error: "+e)}))},E=document.getElementById("upload_container");E&&E.classList.add("live-supported");var I=document.getElementById("drop_area");I&&(["dragenter","dragover","dragleave","drop"].forEach((e=>{I.addEventListener(e,(e=>{e.preventDefault(),e.stopPropagation()}),!1)})),["dragenter","dragover"].forEach((e=>{I.addEventListener(e,(e=>{e.target.classList.add("highlight")}),!1)})),["dragleave","drop"].forEach((e=>{I.addEventListener(e,(e=>{e.target.classList.remove("highlight")}),!1)})),I.addEventListener("drop",(e=>{b(e.dataTransfer.files[0])}),!1));var A=document.getElementById("choose_file_button");A&&A.addEventListener("click",(e=>{e.preventDefault();var t=document.getElementById("file_chooser");t&&(t.addEventListener("change",(e=>{b(e.target.files[0])})),t.click())}))}var k=document.getElementById("username_action_button"),L=document.getElementById("username_field"),M=document.getElementById("suggested-username-link"),T=document.getElementById("new-suggestion-link");k&&L&&(L.addEventListener("input",(e=>{k.disabled=""===e.target.value.trim()})),k.addEventListener("click",(e=>{e.preventDefault();var t=L.value.trim();if(""===t)return a.show("Username can not be empty","How did you press the button anyway?"),!1;var n=new URLSearchParams;n.append("username",t),o.post("/account/actions/username",n).then((e=>{var t={message:"Username changed",explanation:"Your username has been changed."};try{var n=JSON.parse(e.body);t.explanation='Your username has been changed to "'.concat(n.username,'."')}catch(e){}a.show(t.message,t.explanation).then((()=>{window.location.reload(!0)}))})).catch((e=>{401===e.status?a.show("Username not changed","There was an authentication error."):a.show("Username not changed","Sorry, there was a ".concat(e.status," error."))}))})),M&&(M.addEventListener("click",(e=>(e.preventDefault(),L.value=e.currentTarget.getAttribute("beacon-username"),k.disabled=""===L.value.trim(),!1))),T&&T.addEventListener("click",(e=>(o.get("/account/login/suggest").then((e=>{try{var t=JSON.parse(e.body);M&&(M.innerText=t.username,M.setAttribute("beacon-username",t.username))}catch(e){}})).catch((()=>{})),e.preventDefault(),!1)))));var S=document.getElementById("password_action_button"),B=document.getElementById("password_regenerate_check"),H=document.getElementById("change_password_form"),C=document.getElementById("password_current_field"),U=document.getElementById("password_initial_field"),_=document.getElementById("password_confirm_field"),x=document.getElementById("add-authenticator-button"),R=document.getElementById("add-authenticator-code-field"),N=document.getElementById("add-authenticator-nickname-field"),K=document.getElementById("add-authenticator-action-button"),P=document.getElementById("add-authenticator-cancel-button"),F=document.getElementById("add-authenticator-qrcode"),O=document.getElementById("authenticators_time_zone_name"),Y=document.getElementById("replace-backup-codes-button");S&&B&&H&&S.addEventListener("click",(e=>{e.preventDefault();var t=C?C.value:"",n=U?U.value:"",i=_?_.value:"",s=n===r,c=B.checked,u=c;if(n.length<8)return a.show("Password too short","Your password must be at least 8 characters long."),!1;if(n!==i)return a.show("Passwords do not match","Please make sure the two passwords match."),!1;var l=new URLSearchParams;return l.append("current_password",t),l.append("password",n),l.append("allow_vulnerable",s),u&&l.append("terminate_sessions",!0),c&&l.append("regenerate_key",!0),o.post("/account/actions/password",l).then((()=>{H.reset();try{var e={};e.message=c?"Your password and private key have been changed.":"Your password has been changed.",e.explanation="All sessions have been revoked and your devices will need to sign in again.",a.show(e.message,e.explanation)}catch(e){console.log(e),a.show("There was an error. Your password may or may not have been changed.")}})).catch((e=>{var t="Unable to change password",o="There was a ".concat(e.status," error while trying to change your password.");try{var i=JSON.parse(e.body);i.message&&(o=i.message)}catch(e){}switch(e.status){case 403:t="Incorrect Two Step Verification Code",o="Please get a new code from your authenticator app.";break;case 438:r=n,t="Your password is vulnerable.",o="Your password has been leaked in a previous breach and should not be used. To ignore this warning, you may submit the password again, but that is not recommended."}a.show(t,o)})),!1}));var D=()=>{if(S)return C&&U&&_?void(S.disabled=""===C.value.trim()||""===U.value.trim()||U.value!==_.value):(console.log("Missing page fields"),void(S.disabled=!0))};if(C&&C.addEventListener("input",D),U&&U.addEventListener("input",D),_&&_.addEventListener("input",D),x&&R&&N&&K&&P)try{var j={authenticatorId:self.crypto.randomUUID(),type:"TOTP",nickname:"Google Authenticator",metadata:{secret:null,setup:null}};R.addEventListener("input",(e=>{K.disabled=""===e.target.value.trim()})),x.addEventListener("click",(()=>{j.metadata.secret=(()=>{var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",t=new Uint32Array(4);self.crypto.getRandomValues(t);var n="";for(var r of t)n+=e[r>>>27&31]+e[r>>>22&31]+e[r>>>17&31]+e[r>>>12&31]+e[r>>>7&31]+e[r>>>2&31];return n})(),j.metadata.setup="otpauth://totp/".concat(encodeURIComponent("Beacon:"+h+" ("+j.authenticatorId+")"),"?secret=").concat(j.metadata.secret,"&issuer=Beacon"),F&&(F.src="/account/assets/qr.php?content=".concat(btoa(j.metadata.setup)),F.setAttribute("alt",j.metadata.setup),F.setAttribute("title",j.metadata.setup)),R.value="",a.showModal("add-authenticator-modal")})),P.addEventListener("click",(()=>{a.hideModal()})),K.addEventListener("click",(()=>{var e=R.value.trim();if(j.nickname=N.value.trim(),j.verificationCode=e,e!==s()(j.metadata.secret)){R.classList.add("invalid");var t=document.querySelector('label[for="'.concat(R.id,'"]'));return t&&(t.classList.add("invalid"),t.innerText="Incorrect Code"),void setTimeout((()=>{t&&(t.classList.remove("invalid"),t.innerText="Verification Code"),R&&R.classList.remove("invalid")}),3e3)}o.post("https://".concat(c,"/v4/authenticators"),j,{Authorization:"Bearer ".concat(i)}).then((()=>{window.location.reload(!0)})).catch((e=>{console.log(JSON.stringify(e))}))}))}catch(e){x.addEventListener("click",(()=>{a.show("Sorry, this browser is not supported","There was an error generating the authenticator, which means your browser does not support modern cryptography features. Try again with an updated browser.")}))}var z,q,X=document.querySelectorAll("#authenticators-table tbody tr").length;if(X>0){var J=document.querySelectorAll("time");for(var W of J)if(!W.classList.contains("no-localize")){var V=new Date(W.getAttribute("datetime"));V&&(W.innerText=(z=V,q=void 0,(q={dateStyle:"medium"}).timeStyle="short",Intl.DateTimeFormat(Intl.DateTimeFormat().resolvedOptions().locale,q).format(z)))}O&&(O.innerText=Intl.DateTimeFormat().resolvedOptions().timeZone);var G=document.querySelectorAll("button.delete_authenticator_button");for(var Z of G)Z.addEventListener("click",(e=>{var t=e.target.getAttribute("beacon-authenticator-id"),n=e.target.getAttribute("beacon-authenticator-name"),r={message:"Are you sure you want to delete the authenticator ".concat(n,"?")};if(X>1){var s=X-1,u=1===s?"authenticator":"authenticators";r.explanation="You will have ".concat(s," ").concat(u," remaining. Your account will still be protected by two factor authentication.")}else r.explanation="This is your only authenticator. Deleting it will disable two factor authentication for your account. You will be able to add a new authenticator to enable two factor authentication again.";a.confirm(r.message,r.explanation).then((()=>{o.delete("https://".concat(c,"/v4/authenticators/").concat(t),{Authorization:"Bearer ".concat(i)}).then((()=>{var e=document.getElementById("authenticator-".concat(t));e&&X>1?(e.remove(),X--):window.location.reload(!0)})).catch((e=>{var t={message:"The authenticator was not deleted",explanation:"There was a ".concat(e.status," error.")};try{var n=JSON.parse(e.body);n.message&&(t.explanation=n.message)}catch(e){}a.show(t.message,t.explanation)}))})).catch((()=>{}))}))}Y&&Y.addEventListener("click",(()=>{a.confirm("Replace backup codes?","This will replace all of your backup codes with new ones.").then((()=>{o.post("/account/actions/replace_backup_codes",{},{Authorization:"Bearer ".concat(i)}).then((e=>{try{var t=document.getElementById("backup-codes"),n=JSON.parse(e.body).codes;for(var r of(t.innerHTML="",n)){var a=document.createElement("div");a.innerText=r,a.className="flex-grid-item",t.appendChild(a)}}catch(e){window.location.reload(!0)}})).catch((e=>{console.log(JSON.stringify(e));var t={message:"Backup codes not replaced",explanation:"There was a ".concat(e.status," error.")};try{var n=JSON.parse(e.body);n.message&&(t.explanation=n.message)}catch(e){}a.show(t.message,t.explanation)}))})).catch((()=>{}))}));var Q=e=>(e.preventDefault(),o.delete("https://".concat(c,"/v4/sessions/").concat(encodeURIComponent(e.target.getAttribute("sessionHash"))),{Authorization:"Bearer ".concat(i)}).then((()=>{a.show("Session revoked","Be aware that any enabled user with a copy of your account's private key can start a new session.").then((()=>{window.location.reload(!0)}))})).catch((e=>{401===e.status?a.show("Session not revoked","There was an authentication error"):a.show("Session not revoked","Sorry, there was a "+e.status+" error.")})),!1),$=document.querySelectorAll('#panel-account div[page="sessions"] a.revokeLink');for(var ee of $)ee.addEventListener("click",Q);var te=e=>{e.preventDefault();var t=e.currentTarget.getAttribute("beacon-app-id");o.get("https://".concat(c,"/v4/applications/").concat(encodeURIComponent(t)),{Authorization:"Bearer ".concat(i)}).then((e=>{JSON.parse(e.body)})).catch((()=>{a.show("Could not retrieve application info")}))},ne=document.querySelectorAll('#panel-account div[page="apps"] button.apps-edit-button');for(var re of ne)re.addEventListener("click",te);var ae=document.getElementById("static-token-modal"),oe=document.getElementById("static-token-name-field"),ie=document.getElementById("static-token-token-field"),se=document.getElementById("static-token-cancel-button"),ce=document.getElementById("static-token-action-button"),ue=document.getElementById("static-token-provider-field"),le=document.getElementById("static-token-generate-link"),de=document.getElementById("static-token-help-field"),he=document.getElementById("static-token-error-field"),pe=e=>{e.preventDefault();var t=e.currentTarget.getAttribute("beacon-provider"),n=e.currentTarget.getAttribute("beacon-provider-type"),r=e.currentTarget.getAttribute("beacon-token-id"),s=e.currentTarget.getAttribute("beacon-token-name");if(""===r)switch(n){case"oauth":window.location="/account/oauth/v4/begin/".concat(t);break;case"static":if(ae&&oe&&ie&&ue&&le&&de){switch(oe.value="",ie.value="",ue.value=t,he.classList.add("hidden"),t){case"nitrado":le.href="https://server.nitrado.net/usa/developer/tokens",de.innerText='Beacon requires long life tokens from Nitrado to have the "service" scope enabled.',de.classList.remove("hidden");break;case"gameserverapp":le.href="https://dash.gameserverapp.com/configure/api",de.innerText='On your GameServerApp.com dashboard, you will find an "API / Integrate" option where you can issue a token for Beacon. Copy the token into the field below to continue. Remember to keep your token in a safe place in case you need it again.',de.classList.remove("hidden")}a.showModal("static-token-modal")}}else a.confirm("Are you sure you want to remove the service ".concat(s,"?"),"You will be able to connect the service again if you choose to.","Delete","Cancel").then((()=>{o.delete("https://".concat(c,"/v4/tokens/").concat(r),{Authorization:"Bearer ".concat(i)}).then((()=>{window.location.reload(!0)})).catch((()=>{a.show("The service was not deleted.")}))}))},ve=document.querySelectorAll('#panel-account div[page="services"] .service-action button');for(var fe of ve)fe.addEventListener("click",pe);if(ae&&oe&&ie&&se&&ce&&ue&&he){var me=()=>{ce.disabled=""===oe.value.trim()||""===ie.value.trim()};oe.addEventListener("input",(()=>{me()})),ie.addEventListener("input",(()=>{me()})),se.addEventListener("click",(e=>{e.preventDefault(),a.hideModal()})),ce.addEventListener("click",(e=>{e.preventDefault(),ce.disabled=!0,he.classList.add("hidden");var t={provider:ue.value,type:"Static",accessToken:ie.value.trim(),providerSpecific:{tokenName:oe.value.trim()}},n=()=>{o.post("https://".concat(c,"/v4/user/tokens"),t,{Authorization:"Bearer ".concat(i)}).then((()=>{window.location.reload(!0)})).catch((()=>{he.innerText="Could not save token.",he.classList.remove("hidden"),ce.disabled=!1}))};"nitrado"===t.provider?o.get("https://api.nitrado.net/token",{Authorization:"Bearer ".concat(t.accessToken)}).then((e=>{var r=JSON.parse(e.body);if(!1===r.data.token.scopes.includes("service"))return he.innerText='The long life token is valid, but is missing the "service" scope that Beacon requires.',he.classList.remove("hidden"),void(ce.disabled=!1);t.providerSpecific.user=r.data.token.user,n()})).catch((()=>{he.innerText="The long life token is not valid. Double check the Nitrado website, as the beginning of the token can wrap to another line.",he.classList.remove("hidden"),ce.disabled=!1})):n()}))}}))})()})();