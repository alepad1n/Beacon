"use strict";var numberOfChecks=0;document.addEventListener("DOMContentLoaded",()=>{var clientReferenceId=null;if(sessionStorage){clientReferenceId=sessionStorage.getItem("clientReferenceId")}setTimeout(()=>{checkPurchaseStatus(clientReferenceId)},1000);localStorage.removeItem("beaconCart")});var checkPurchaseStatus=clientReferenceId=>{var checkingContainer=document.getElementById("checking_container");var purchaseUnknown=document.getElementById("purchase_unknown");var purchaseDelayed=document.getElementById("purchase_delayed");var purchaseConfirmed=document.getElementById("purchase_confirmed");var signinInstructions=document.getElementById("signin_instructions");var confirmedText=document.getElementById("confirmed_text");var checkingSubtext=document.getElementById("checking_subtext");var activateButton=document.getElementById("activate_button");if(clientReferenceId===null){checkingContainer.style.display="none";purchaseUnknown.style.display="block";signinInstructions.style.display="block";return}numberOfChecks++;BeaconWebRequest.get("status?client_reference_id=".concat(encodeURIComponent(clientReferenceId))).then(response=>{try{checkingContainer.style.display="none";purchaseConfirmed.style.display="block";var obj=JSON.parse(response.body);var userId=obj.user_id;var email=obj.email;var returnUrl="".concat(window.location.origin,"/account/#omni");var accountUrl="".concat(window.location.origin,"/account/login?return=").concat(encodeURIComponent(returnUrl));if(email!==null){accountUrl+="&email=".concat(encodeURIComponent(email))}if(userId===null){accountUrl+="#create";if(email===null){confirmedText.innerText="You will need to create an account with the email address used to purchase to activate Omni in Beacon.";activateButton.innerText="Create Account"}else{confirmedText.innertText="An email was sent to ".concat(email," to confirm your email address. Follow the included link to finish setting up your account. Be sure to check junk folders. Despite our best efforts, one of the major email providers likes to tag Beacon emails as spam.");activateButton.className="hidden"}}activateButton.setAttribute("href",accountUrl)}catch(e){console.log(e);BeaconDialog.show("There was an error checking your purchase status.")}}).catch(error=>{setTimeout(()=>{if(numberOfChecks===1){checkingSubtext.innerText="\nWaiting for purchase details from Stripe\u2026"}else{purchaseDelayed.style.display="block";signinInstructions.style.display="block"}checkPurchaseStatus(clientReferenceId)},5000)})};