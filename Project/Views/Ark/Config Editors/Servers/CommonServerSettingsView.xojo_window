#tag DesktopWindow
Begin BeaconContainer CommonServerSettingsView
   AllowAutoDeactivate=   True
   AllowFocus      =   False
   AllowFocusRing  =   False
   AllowTabs       =   True
   Backdrop        =   0
   BackgroundColor =   &cFFFFFF00
   Composited      =   False
   Enabled         =   True
   HasBackgroundColor=   False
   Height          =   532
   Index           =   -2147483648
   InitialParent   =   ""
   Left            =   0
   LockBottom      =   True
   LockLeft        =   True
   LockRight       =   True
   LockTop         =   True
   TabIndex        =   0
   TabPanelIndex   =   0
   TabStop         =   True
   Tooltip         =   ""
   Top             =   0
   Transparent     =   True
   Visible         =   True
   Width           =   648
   Begin UITweaks.ResizedLabel ServerNameLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   0
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Server Name:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   20
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
   Begin UITweaks.ResizedTextField ServerNameField
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   20
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   460
   End
   Begin UITweaks.ResizedLabel ConfigSetLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   4
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Config Sets:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   88
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
   Begin UITweaks.ResizedLabel ConfigSetField
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   5
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Base"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   88
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   368
   End
   Begin UITweaks.ResizedPushButton ConfigSetChooseButton
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Chooseâ€¦"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   548
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   False
      LockRight       =   True
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   6
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   88
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   80
   End
   Begin UITweaks.ResizedLabel MessageOfTheDayLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   10
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Message of the Day:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   152
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
   Begin ArkMLEditor MessageOfTheDayArea
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   False
      AllowTabs       =   True
      Backdrop        =   0
      BackgroundColor =   &cFFFFFF00
      Composited      =   False
      Enabled         =   True
      HasBackgroundColor=   False
      Height          =   145
      Index           =   -2147483648
      InitialParent   =   ""
      JSONData        =   ""
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      RTFData         =   ""
      Scope           =   2
      TabIndex        =   11
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   152
      Transparent     =   True
      Visible         =   True
      Width           =   460
   End
   Begin UITweaks.ResizedLabel MessageDurationLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   12
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Message Duration:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   309
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
   Begin RangeField MessageDurationField
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      DoubleValue     =   0.0
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   13
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   2
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   309
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   80
   End
   Begin UITweaks.ResizedLabel MessageDurationSuffixLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   260
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   14
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Seconds"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   309
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   320
   End
   Begin UITweaks.ResizedTextField AdminPasswordField
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   220
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   17
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   342
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   408
   End
   Begin UITweaks.ResizedTextField ServerPasswordField
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   220
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   20
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   376
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   408
   End
   Begin UITweaks.ResizedTextField SpectatorPasswordField
      AllowAutoDeactivate=   True
      AllowFocusRing  =   True
      AllowSpellChecking=   False
      AllowTabs       =   False
      BackgroundColor =   &cFFFFFF00
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Format          =   ""
      HasBorder       =   True
      Height          =   22
      Hint            =   ""
      Index           =   -2147483648
      Italic          =   False
      Left            =   220
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      MaximumCharactersAllowed=   0
      Password        =   False
      ReadOnly        =   False
      Scope           =   2
      TabIndex        =   23
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   ""
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   410
      Transparent     =   False
      Underline       =   False
      ValidationMask  =   ""
      Visible         =   True
      Width           =   408
   End
   Begin UITweaks.ResizedLabel AdminPasswordLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   15
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Admin Password:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   342
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
   Begin SwitchControl AdminPasswordSwitch
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      ContentHeight   =   0
      Enabled         =   True
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   16
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   343
      Transparent     =   True
      Visible         =   True
      Width           =   40
   End
   Begin UITweaks.ResizedLabel ServerPasswordLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   18
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Server Password:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   376
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
   Begin UITweaks.ResizedLabel SpectatorPasswordLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   21
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Spectator Password:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   410
      Transparent     =   True
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
   Begin SwitchControl ServerPasswordSwitch
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      ContentHeight   =   0
      Enabled         =   True
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   19
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   377
      Transparent     =   True
      Visible         =   True
      Width           =   40
   End
   Begin SwitchControl SpectatorPasswordSwitch
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      ContentHeight   =   0
      Enabled         =   True
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   22
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   411
      Transparent     =   True
      Visible         =   True
      Width           =   40
   End
   Begin UITweaks.ResizedLabel MapLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Build Config For:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   120
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
   Begin UITweaks.ResizedPopupMenu MapMenu
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   ""
      Italic          =   False
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      SelectedRowIndex=   0
      TabIndex        =   8
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   120
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   165
   End
   Begin UITweaks.ResizedLabel MapHelp
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "SmallSystem"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   True
      Left            =   345
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   9
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Does not change the map"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   120
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   199
   End
   Begin ProfileColorChooser ColorChooser
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      ContentHeight   =   0
      Enabled         =   True
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   168
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      ScrollActive    =   False
      ScrollingEnabled=   False
      ScrollSpeed     =   20
      TabIndex        =   3
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   54
      Transparent     =   True
      Visible         =   True
      Width           =   220
   End
   Begin UITweaks.ResizedLabel ColorLabel
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   22
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   2
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Color:"
      TextAlignment   =   3
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   54
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   136
   End
End
#tag EndDesktopWindow

#tag WindowCode
	#tag Method, Flags = &h21
		Private Function Modified() As Boolean
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    If (Profile Is Nil) = False And Profile.Modified Then
		      Return True
		    End If
		  Next
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Function Profile() As Ark.ServerProfile
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    If (Profile Is Nil) = False Then
		      Return Profile
		    End If
		  Next
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Profile(Assigns Profile As Ark.ServerProfile)
		  Var Items(0) As Ark.ServerProfile
		  Items(0) = Profile
		  Self.Profiles = Items
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h0
		Function Profiles() As Ark.ServerProfile()
		  Return Self.mProfiles
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub Profiles(Assigns Items() As Ark.ServerProfile)
		  Self.mProfiles = Items
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function Project() As Ark.Project
		  Return RaiseEvent GetProject
		End Function
	#tag EndMethod

	#tag Method, Flags = &h0
		Sub RefreshUI()
		  Var Profile As Ark.ServerProfile = Self.Profile
		  
		  If Self.SettingUp Or Profile Is Nil Then
		    Return
		  End If
		  
		  Self.mSettingUp = True
		  
		  Self.ServerNameField.Text = Profile.Name
		  
		  Var MOTD As Ark.ArkML
		  If (Profile.MessageOfTheDay Is Nil) = False Then
		    MOTD = Profile.MessageOfTheDay
		  Else
		    MOTD = New Ark.ArkML
		  End If
		  Self.MessageOfTheDayArea.RTFData = MOTD.RTFValue
		  Self.MessageDurationField.DoubleValue = Profile.MessageDuration
		  
		  If Profile.AdminPassword Is Nil Then
		    Self.AdminPasswordSwitch.Value(False) = False
		    Self.AdminPasswordField.Text = ""
		  Else
		    Self.AdminPasswordSwitch.Value(False) = True
		    Self.AdminPasswordField.Text = Profile.AdminPassword.StringValue
		  End If
		  
		  If Profile.ServerPassword Is Nil Then
		    Self.ServerPasswordSwitch.Value(False) = False
		    Self.ServerPasswordField.Text = ""
		  Else
		    Self.ServerPasswordSwitch.Value(False) = True
		    Self.ServerPasswordField.Text = Profile.ServerPassword.StringValue
		  End If
		  
		  If Profile.SpectatorPassword Is Nil Then
		    Self.SpectatorPasswordSwitch.Value(False) = False
		    Self.SpectatorPasswordField.Text = ""
		  Else
		    Self.SpectatorPasswordSwitch.Value(False) = True
		    Self.SpectatorPasswordField.Text = Profile.SpectatorPassword.StringValue
		  End If
		  
		  If Self.mShowsMapMenu Then
		    Self.MapMenu.SelectByTag(Profile.Mask)
		  End If
		  
		  Var NeedsLayoutUpdate As Boolean = (Self.MapMenu.Top < 0 And Self.mShowsMapMenu = True) Or (Self.MapMenu.Top > 0 And Self.mShowsMapMenu = False)
		  If NeedsLayoutUpdate Then
		    Var MapGroup As New ControlGroup(Self.MapHelp, Self.MapLabel, Self.MapMenu)
		    Var OtherGroup As New ControlGroup(Self.AdminPasswordField, Self.AdminPasswordLabel, Self.AdminPasswordSwitch, Self.MessageDurationField, Self.MessageDurationLabel, Self.MessageDurationSuffixLabel, Self.ServerPasswordField, Self.ServerPasswordLabel, Self.ServerPasswordSwitch, Self.SpectatorPasswordField, Self.SpectatorPasswordLabel, Self.SpectatorPasswordSwitch)
		    
		    If Self.mShowsMapMenu Then
		      MapGroup.Top = Self.ConfigSetField.Top + Self.ConfigSetField.Height + 12
		      Self.MessageOfTheDayArea.Top = MapGroup.Top + MapGroup.Height + 12
		      Self.MessageOfTheDayLabel.Top = Self.MessageOfTheDayArea.Top
		    Else
		      MapGroup.Top = (20 + MapGroup.Height) * -1
		      Self.MessageOfTheDayArea.Top = Self.ConfigSetField.Top + Self.ConfigSetField.Height + 12
		      Self.MessageOfTheDayLabel.Top = Self.MessageOfTheDayArea.Top
		    End If
		    
		    OtherGroup.Top = Self.MessageOfTheDayArea.Top + Self.MessageOfTheDayArea.Height + 12
		    MapGroup.Visible = Self.mShowsMapMenu
		  End If
		  
		  Self.ColorChooser.SelectedColor = Profile.ProfileColor
		  
		  Self.UpdateConfigSetUI()
		  
		  Self.mSettingUp = False
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub UpdateConfigSetUI()
		  Var Project As Ark.Project = Self.Project
		  
		  If Project.ConfigSetCount > 1 Then
		    Var States() As Beacon.ConfigSetState
		    Var Profile As Ark.ServerProfile = Self.Profile
		    If (Profile Is Nil) = False Then
		      States = Profile.ConfigSetStates(Project)
		    End If
		    Var EnabledSets() As String
		    For Each State As Beacon.ConfigSetState In States
		      If State.Enabled Then
		        EnabledSets.Add(State.Name)
		      End If
		    Next
		    
		    Self.ConfigSetField.Text = EnabledSets.EnglishOxfordList()
		    Self.ConfigSetChooseButton.Enabled = True
		  Else
		    Self.ConfigSetField.Text = Ark.Project.BaseConfigSetName
		    Self.ConfigSetChooseButton.Enabled = False
		  End If
		End Sub
	#tag EndMethod


	#tag Hook, Flags = &h0
		Event GetProject() As Ark.Project
	#tag EndHook


	#tag Property, Flags = &h21
		Private mProfiles() As Ark.ServerProfile
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mSettingUp As Boolean
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mShowsMapMenu As Boolean = True
	#tag EndProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mSettingUp
			End Get
		#tag EndGetter
		SettingUp As Boolean
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return Self.mShowsMapMenu
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  If Self.mShowsMapMenu <> Value Then
			    Self.mShowsMapMenu = Value
			    Self.RefreshUI
			  End If
			End Set
		#tag EndSetter
		ShowsMapMenu As Boolean
	#tag EndComputedProperty


#tag EndWindowCode

#tag Events ServerNameField
	#tag Event
		Sub TextChanged()
		  If Self.mSettingUp Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.Name = Me.Text
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events ConfigSetChooseButton
	#tag Event
		Sub Pressed()
		  Var MainProfile As Ark.ServerProfile = Self.Profile
		  If MainProfile Is Nil Then
		    Return
		  End If
		  
		  Var States() As Beacon.ConfigSetState = MainProfile.ConfigSetStates(Self.Project)
		  Var ChangedStates() As Beacon.ConfigSetState = ArkConfigSetSelectorDialog.Present(Self, States)
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.ConfigSetStates = ChangedStates
		  Next
		  Self.UpdateConfigSetUI()
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events MessageOfTheDayArea
	#tag Event
		Sub TextChanged()
		  If Self.mSettingUp Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.MessageOfTheDay = Ark.ArkML.FromRTF(Me.RTFData)
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events MessageDurationField
	#tag Event
		Sub GetRange(ByRef MinValue As Double, ByRef MaxValue As Double)
		  MinValue = 0
		  MaxValue = 86400
		End Sub
	#tag EndEvent
	#tag Event
		Sub ValueChanged()
		  If Self.mSettingUp Then
		    Return
		  End If
		  
		  If IsNumeric(Me.Text) = False Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.MessageDuration = Me.DoubleValue
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events AdminPasswordField
	#tag Event
		Sub TextChanged()
		  If Self.SettingUp Or Self.AdminPasswordSwitch.Value = False Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.AdminPassword = Me.Text
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events ServerPasswordField
	#tag Event
		Sub TextChanged()
		  If Self.SettingUp Or Self.ServerPasswordSwitch.Value = False Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.ServerPassword = Me.Text
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SpectatorPasswordField
	#tag Event
		Sub TextChanged()
		  If Self.SettingUp Or Self.SpectatorPasswordSwitch.Value = False Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.SpectatorPassword = Me.Text
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events AdminPasswordSwitch
	#tag Event
		Sub Pressed()
		  Self.AdminPasswordField.Enabled = Me.Value
		  
		  If Self.mSettingUp Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    If Me.Value Then
		      Profile.AdminPassword = Self.AdminPasswordField.Text
		    Else
		      Profile.AdminPassword = Nil
		    End If
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events ServerPasswordSwitch
	#tag Event
		Sub Pressed()
		  Self.ServerPasswordField.Enabled = Me.Value
		  
		  If Self.mSettingUp Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    If Me.Value Then
		      Profile.ServerPassword = Self.ServerPasswordField.Text
		    Else
		      Profile.ServerPassword = Nil
		    End If
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events SpectatorPasswordSwitch
	#tag Event
		Sub Pressed()
		  Self.SpectatorPasswordField.Enabled = Me.Value
		  
		  If Self.mSettingUp Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    If Me.Value Then
		      Profile.SpectatorPassword = Self.SpectatorPasswordField.Text
		    Else
		      Profile.SpectatorPassword = Nil
		    End If
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events MapMenu
	#tag Event
		Sub Opening()
		  Me.AddRow("All Maps", Ark.Maps.UniversalMask)
		  
		  Var Maps() As Ark.Map = Ark.Maps.All
		  For Each Map As Ark.Map In Maps
		    Me.AddRow(Map.Name, Map.Mask)
		  Next
		End Sub
	#tag EndEvent
	#tag Event
		Sub SelectionChanged(item As DesktopMenuItem)
		  #Pragma Unused Item
		  
		  If Self.SettingUp Or Self.mShowsMapMenu = False Then
		    Return
		  End If
		  
		  Var Mask As UInt64
		  If Me.SelectedRowIndex = -1 Then
		    Mask = Ark.Maps.UniversalMask
		  Else
		    Mask = Me.RowTagAt(Me.SelectedRowIndex)
		  End If
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.Mask = Mask
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events ColorChooser
	#tag Event
		Sub Change()
		  If Self.mSettingUp Then
		    Return
		  End If
		  
		  For Each Profile As Ark.ServerProfile In Self.mProfiles
		    Profile.ProfileColor = Me.SelectedColor
		  Next
		  Self.Modified = Self.Modified
		End Sub
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="Modified"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Composited"
		Visible=true
		Group="Window Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Index"
		Visible=true
		Group="ID"
		InitialValue="-2147483648"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Size"
		InitialValue="300"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Left"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Top"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockLeft"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockTop"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockRight"
		Visible=true
		Group="Position"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="LockBottom"
		Visible=true
		Group="Position"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabIndex"
		Visible=true
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabStop"
		Visible=true
		Group="Position"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowAutoDeactivate"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Enabled"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Tooltip"
		Visible=true
		Group="Appearance"
		InitialValue=""
		Type="String"
		EditorType="MultiLineEditor"
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowFocusRing"
		Visible=true
		Group="Appearance"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Appearance"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="BackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="&hFFFFFF"
		Type="ColorGroup"
		EditorType="ColorGroup"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Background"
		InitialValue=""
		Type="Picture"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowFocus"
		Visible=true
		Group="Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="AllowTabs"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Transparent"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="SettingUp"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="ShowsMapMenu"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="InitialParent"
		Visible=false
		Group="Position"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="TabPanelIndex"
		Visible=false
		Group="Position"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
#tag EndViewBehavior
